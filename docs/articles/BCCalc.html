<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compute Back-Calculated Lengths • RFishBC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Compute Back-Calculated Lengths">
<meta property="og:description" content="RFishBC">
<meta property="og:image" content="http://derekogle.com/RFishBC/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RFishBC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BCIntro.html">Short Introduction</a>
    </li>
    <li>
      <a href="../articles/collectRadiiData.html">Collect Radii Data</a>
    </li>
    <li>
      <a href="../articles/seeRadiiData.html">Visualize Radii Data</a>
    </li>
    <li>
      <a href="../articles/BCCalc.html">Back-Calculating Lengths</a>
    </li>
    <li>
      <a href="../articles/BCWorkflow.html">Suggested Workflow</a>
    </li>
    <li>
      <a href="../articles/Other.html">Other Features</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/droglenc/RFishBC" class="external-link">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Compute Back-Calculated Lengths</h1>
                        <h4 data-toc-skip class="author">Derek H. Ogle</h4>
            
            <h4 data-toc-skip class="date">2022-02-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/droglenc/RFishBC/blob/HEAD/vignettes/BCCalc.Rmd" class="external-link"><code>vignettes/BCCalc.Rmd</code></a></small>
      <div class="hidden name"><code>BCCalc.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to back-calculate lengths at previous ages from radial measurements made on calcified structures of fish. This vignette assumes that you have an understanding of</p>
<ul>
<li>back-calculation (as described in the <a href="../BCIntro/BCIntro.html">Short Introduction to Back-calculation</a> vignette),</li>
<li>how to use <code><a href="../reference/combineData.html">combineData()</a></code> to combine R data files created from <code><a href="../reference/digitizeRadii.html">digitizeRadii()</a></code> and join fish-specific information as described in the <a href="../MeasureRadii/collectRadiiData.html">Collecting Radii Data</a> vignette.</li>
</ul>
<p>Packages used in this vignette are loaded below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://derekogle.com/RFishBC/" class="external-link">RFishBC</a></span><span class="op">)</span>   <span class="co"># for bcFuns()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/droglenc/FSA" class="external-link">FSA</a></span><span class="op">)</span>       <span class="co"># for validn(), sumTable()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>     <span class="co"># for %&gt;%, inner_join(), arrange(), group_by, summarize()</span></code></pre></div>
<p>Finally, some of the data manipulations used in this vignette, which may not be familiar to all readers, are described in detail in Ogle (2016).</p>
<p> </p>
<p> </p>
<hr>
</div>
<div class="section level2">
<h2 id="data-for-back-calculation">Data for Back-Calculation<a class="anchor" aria-label="anchor" href="#data-for-back-calculation"></a>
</h2>
<p>The radial measurements from multiple fish should be combined into one data.frame using <code><a href="../reference/combineData.html">combineData()</a></code>. In addition, the length-at-capture for each fish should be appended to that data.frame. A method to combine radial measurements from multiple fish and append a length-at-capture variable was demonstrated in the <a href="../MeasureRadii/collectRadiiData.html#outputdata">Output Data File section of the Collecting Radii Data</a> vignette.</p>
<p>Several of the back-calculation methods require estimating parameters from the relationship between fish length and structure radius or structure radius and fish length (as described in <a href="../BCIntro/BCIntro.html">Short Introduction to Back-calculation</a> vignette). These methods cannot be demonstrated well with a small number of fish (as in the <a href="../MeasureRadii/collectRadiiData.html">Collecting Radii Data</a> vignette). Thus, data from a large number of Smallmouth Bass (<em>Micropterus dolomieu</em>) collected from West Bearskin Lake (MN) in 1990 will be used in this vignette.</p>
<p>A data.frame of the Smallmouth Bass data as it would appear from <code><a href="../reference/combineData.html">combineData()</a></code> is obtained as follows.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SMBassWB2</span>,package<span class="op">=</span><span class="st">"RFishBC"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SMBassWB2</span><span class="op">)</span>
<span class="co">#&gt;    id reading agecap  radcap    rad1    rad2 rad3 rad4 rad5 rad6 rad7 rad8 rad9</span>
<span class="co">#&gt; 1 482     DHO      1 1.51076 1.51076      NA   NA   NA   NA   NA   NA   NA   NA</span>
<span class="co">#&gt; 2 768     DHO      1 1.57989 1.57989      NA   NA   NA   NA   NA   NA   NA   NA</span>
<span class="co">#&gt; 3 428     DHO      1 1.48721 1.48721      NA   NA   NA   NA   NA   NA   NA   NA</span>
<span class="co">#&gt; 4 478     DHO      2 2.73596 1.60554 2.73596   NA   NA   NA   NA   NA   NA   NA</span>
<span class="co">#&gt; 5 379     DHO      2 3.05503 1.59628 3.05503   NA   NA   NA   NA   NA   NA   NA</span>
<span class="co">#&gt; 6 477     DHO      2 2.44914 1.32061 2.44914   NA   NA   NA   NA   NA   NA   NA</span></code></pre></div>
<p>A data.frame of fish-specific information, most importantly the length-at-capture, is obtained as follows.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SMBassWB1</span>,package<span class="op">=</span><span class="st">"RFishBC"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SMBassWB1</span><span class="op">)</span>
<span class="co">#&gt;   id species lake gear yearcap lencap</span>
<span class="co">#&gt; 1  5     SMB   WB    E    1988     71</span>
<span class="co">#&gt; 2  3     SMB   WB    E    1988     64</span>
<span class="co">#&gt; 3  2     SMB   WB    E    1988     57</span>
<span class="co">#&gt; 4  4     SMB   WB    E    1988     68</span>
<span class="co">#&gt; 5  6     SMB   WB    E    1988     72</span>
<span class="co">#&gt; 6  7     SMB   WB    E    1988     80</span></code></pre></div>
<p>These data can be joined by the common <code>id</code> variable as shown in the <a href="../MeasureRadii/collectRadiiData.html#outputdata">Output Data File section of the Collecting Radii Data</a> vignette. The data were also arranged by <code>id</code> to facilitate comparisons throughout this vignette.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SMBassWB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">SMBassWB1</span>,<span class="va">SMBassWB2</span>,by<span class="op">=</span><span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SMBassWB</span>,n<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;    id species lake gear yearcap lencap reading agecap  radcap    rad1    rad2</span>
<span class="co">#&gt; 1 374     SMB   WB    E    1990    243     DHO      7 7.57375 1.01672 2.39296</span>
<span class="co">#&gt; 2 375     SMB   WB    E    1990    293     DHO      7 9.74397 1.76579 3.26580</span>
<span class="co">#&gt; 3 376     SMB   WB    E    1990    214     DHO      7 5.34522 1.02621 1.93058</span>
<span class="co">#&gt;      rad3    rad4    rad5    rad6    rad7 rad8 rad9</span>
<span class="co">#&gt; 1 3.47635 4.37718 5.18976 6.09176 7.57375   NA   NA</span>
<span class="co">#&gt; 2 4.35377 5.41608 7.14118 8.79697 9.74397   NA   NA</span>
<span class="co">#&gt; 3 2.58000 3.24923 4.05444 4.73920 5.34522   NA   NA</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">SMBassWB</span>,n<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;      id species lake gear yearcap lencap reading agecap  radcap    rad1    rad2</span>
<span class="co">#&gt; 179 767     SMB   WB    E    1990     99     DHO      2 2.34205 1.44159 2.34205</span>
<span class="co">#&gt; 180 768     SMB   WB    E    1990     75     DHO      1 1.57989 1.57989      NA</span>
<span class="co">#&gt; 181 998     SMB   WB    E    1990    298     DHO      7 8.54805 1.37828 2.70647</span>
<span class="co">#&gt;        rad3    rad4    rad5   rad6    rad7 rad8 rad9</span>
<span class="co">#&gt; 179      NA      NA      NA     NA      NA   NA   NA</span>
<span class="co">#&gt; 180      NA      NA      NA     NA      NA   NA   NA</span>
<span class="co">#&gt; 181 3.60701 4.48222 5.17646 6.6224 8.54805   NA   NA</span></code></pre></div>
<p>Note that the variables in this data frame are defined as follows:<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<ul>
<li>
<strong>id</strong>: A fish’s unique identification number.</li>
<li>
<strong>species</strong>: Species of fish.</li>
<li>
<strong>lake</strong>: Lake where fish was collected.</li>
<li>
<strong>gear</strong>: Gear used to collect the fish.</li>
<li>
<strong>yearcap</strong>: Year that the fish was captured.</li>
<li>
<strong>lencap</strong>: Fish length at the time of capture.</li>
<li>
<strong>reading</strong>: The specific reading of the structure.</li>
<li>
<strong>agecap</strong>: Fish age at the time of capture.</li>
<li>
<strong>radcap</strong>: Total structure radius at the time of capture.</li>
<li>
<strong>radX</strong>: A radial measurement to the “X”th annulus. Note the many “NA” values to annuli that were larger than the age-at-capture.</li>
</ul>
<p> </p>
<p> </p>
<hr>
</div>
<div class="section level2">
<h2 id="computing-back-calculated-lengths">Computing Back-Calculated Lengths<a class="anchor" aria-label="anchor" href="#computing-back-calculated-lengths"></a>
</h2>
<p>A data.frame of back-calculated lengths (<span class="math inline">\(L_{i}\)</span>) can be constructed from a data.frame that contains at least the length-at-capture (<span class="math inline">\(L_{cap}\)</span>), structure radius-at-capture (<span class="math inline">\(R_{cap}\)</span>), and the structure radius at each annulus (<span class="math inline">\(R_{i}\)</span>) with <code><a href="../reference/backCalc.html">backCalc()</a></code>.</p>
<p>The first argument to this function is a data.frame with the <span class="math inline">\(L_{cap}\)</span>, <span class="math inline">\(R_{cap}\)</span>, and <span class="math inline">\(R_{i}\)</span> data in either “long” or “wide” format. A long-format data.frame <strong>MUST</strong> have the following variable names:</p>
<ul>
<li>
<code>id</code>: Unique fish identification variable.</li>
<li>
<code>agecap</code>: The fish’s age at capture.</li>
<li>
<code>ann</code>: The annulus number.</li>
<li>
<code>rad</code>: The structure radius (at an annulus).</li>
<li>
<code>radcap</code>: The total structure radius at the time of capture.</li>
</ul>
<p>A wide-format data.frame <strong>MUST</strong> have the following variable names:</p>
<ul>
<li>
<code>id</code>: Unique fish identification variable.</li>
<li>
<code>agecap</code>: The fish’s age at capture.</li>
<li>
<code>radcap</code>: The total structure radius at the time of capture.</li>
<li>
<code>radX</code>: Multiple variables that contain the structure radius to the Xth annulus.</li>
</ul>
<p>These data.frames will be in these required formats if the data originated from the <code><a href="../reference/combineData.html">combineData()</a></code> function.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> Other variables may exist in the data.frame, but these variables must exist with the names and contents shown here.</p>
<p>The data.frame <strong>MUST</strong> also have a variable that contains the fish’s length-at-capture. The name for this variable <strong>MUST</strong> be given (without quotes) in the second or <code>lencap=</code> argument.</p>
<p>The format for the input data.frame <strong>MUST</strong> be given in <code>inFormat=</code>. The two choices for this argument are <code>"long"</code> and <code>"wide"</code>.</p>
<p>Finally, one of the many back-calculation models discussed in Vigliola and Meekan (2009) must be selected for use with the <code>BCM=</code> argument. The back-calculation model can be chosen by “name” or number, both of which can be seen in <a href="../../reference/bcFuns.html">the documentation for <code>bcFuns()</code></a>. For example, the popular Fraser-Lee model can be selected with <code>BCM="FRALE"</code> or <code>BCM=2</code>.</p>
<p>Some of the models require parameters estimated from models fit to the relationship between fish length and structure radius or structure radius and fish length. These models will be fit “behind-the-scenes” in <code><a href="../reference/backCalc.html">backCalc()</a></code>. However, some models also require parameters estimated without the observed data, which must then be provided by the user. For example, the Fraser-Lee model uses a length correction factor that may be the estimated length when the structure first forms or a standard published value for a species (Carlander 1980). If the user wants to provide one of these values, then it is given in the <code>a=</code> argument.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> Other parameters for other models may be given in other arguments to <code><a href="../reference/backCalc.html">backCalc()</a></code> (see <a href="../../reference/backCalc.html">the documentation for <code>backCalc()</code></a>).</p>
<p>The results of <code><a href="../reference/backCalc.html">backCalc()</a></code> can be returned in either “long” or “wide” format as identified with <code>outFormat=</code> (which defaults to be the same as <code>inFormat=</code>). The number of digits for the back-calculated lengths may be controlled with <code>digits=</code>.</p>
<p>For example, back-calculated lengths were constructed from the wide-format data in <code>SMBassWB</code>, which has length-at-capture data in the <code>lencap</code> variable, using the Fraser-Lee model (with the “a” parameter estimated from the data) with the code below. The lengths were rounded to whole numbers (i.e., <code>digits=0</code>) and the results were returned in wide-format (the same as the input format).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SMBassWB_FL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/backCalc.html">backCalc</a></span><span class="op">(</span><span class="va">SMBassWB</span>,<span class="va">lencap</span>,BCM<span class="op">=</span><span class="st">"FRALE"</span>,inFormat<span class="op">=</span><span class="st">"wide"</span>,digits<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #00BB00;">&lt;U+2714&gt;</span> Using the Fraser-Lee model with a=41.6516606795389.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SMBassWB_FL</span>,n<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;    id species lake gear yearcap lencap reading agecap len1 len2 len3 len4 len5</span>
<span class="co">#&gt; 1 374     SMB   WB    E    1990    243     DHO      7   69  105  134  158  180</span>
<span class="co">#&gt; 2 375     SMB   WB    E    1990    293     DHO      7   87  126  154  181  226</span>
<span class="co">#&gt; 3 376     SMB   WB    E    1990    214     DHO      7   75  104  125  146  172</span>
<span class="co">#&gt;   len6 len7 len8 len9</span>
<span class="co">#&gt; 1  204  243   NA   NA</span>
<span class="co">#&gt; 2  269  293   NA   NA</span>
<span class="co">#&gt; 3  194  214   NA   NA</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">SMBassWB_FL</span>,n<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;      id species lake gear yearcap lencap reading agecap len1 len2 len3 len4</span>
<span class="co">#&gt; 179 767     SMB   WB    E    1990     99     DHO      2   77   99   NA   NA</span>
<span class="co">#&gt; 180 768     SMB   WB    E    1990     75     DHO      1   75   NA   NA   NA</span>
<span class="co">#&gt; 181 998     SMB   WB    E    1990    298     DHO      7   83  123  150  176</span>
<span class="co">#&gt;     len5 len6 len7 len8 len9</span>
<span class="co">#&gt; 179   NA   NA   NA   NA   NA</span>
<span class="co">#&gt; 180   NA   NA   NA   NA   NA</span>
<span class="co">#&gt; 181  197  240  298   NA   NA</span></code></pre></div>
<p>The example below uses the same data and same back-calculation model, but with the results returned in long-format which is more conducive to statistical summarization and modeling.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SMBassWB_FL2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/backCalc.html">backCalc</a></span><span class="op">(</span><span class="va">SMBassWB</span>,<span class="va">lencap</span>,BCM<span class="op">=</span><span class="st">"FRALE"</span>,
                         inFormat<span class="op">=</span><span class="st">"wide"</span>,outFormat<span class="op">=</span><span class="st">"long"</span>,digits<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #00BB00;">&lt;U+2714&gt;</span> Using the Fraser-Lee model with a=41.6516606795389.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SMBassWB_FL2</span>,n<span class="op">=</span><span class="fl">6</span><span class="op">)</span>
<span class="co">#&gt;      id species lake gear yearcap lencap reading agecap ann bclen</span>
<span class="co">#&gt; 1   374     SMB   WB    E    1990    243     DHO      7   1    69</span>
<span class="co">#&gt; 182 374     SMB   WB    E    1990    243     DHO      7   2   105</span>
<span class="co">#&gt; 363 374     SMB   WB    E    1990    243     DHO      7   3   134</span>
<span class="co">#&gt; 544 374     SMB   WB    E    1990    243     DHO      7   4   158</span>
<span class="co">#&gt; 725 374     SMB   WB    E    1990    243     DHO      7   5   180</span>
<span class="co">#&gt; 906 374     SMB   WB    E    1990    243     DHO      7   6   204</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">SMBassWB_FL2</span>,n<span class="op">=</span><span class="fl">6</span><span class="op">)</span>
<span class="co">#&gt;       id species lake gear yearcap lencap reading agecap ann bclen</span>
<span class="co">#&gt; 362  998     SMB   WB    E    1990    298     DHO      7   2   123</span>
<span class="co">#&gt; 543  998     SMB   WB    E    1990    298     DHO      7   3   150</span>
<span class="co">#&gt; 724  998     SMB   WB    E    1990    298     DHO      7   4   176</span>
<span class="co">#&gt; 905  998     SMB   WB    E    1990    298     DHO      7   5   197</span>
<span class="co">#&gt; 1086 998     SMB   WB    E    1990    298     DHO      7   6   240</span>
<span class="co">#&gt; 1267 998     SMB   WB    E    1990    298     DHO      7   7   298</span></code></pre></div>
<p> </p>
<p> </p>
<hr>
</div>
<div class="section level2">
<h2 id="summarizing-back-calculated-lengths">Summarizing Back-Calculated Lengths<a class="anchor" aria-label="anchor" href="#summarizing-back-calculated-lengths"></a>
</h2>
<p>For example, the mean back-calculated length-at-age may be computed with <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize()</a></code> as shown below for the long-format Fraser-Lee results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">SMBassWB_FL2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ann</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/FSA/man/validn.html" class="external-link">validn</a></span><span class="op">(</span><span class="va">bclen</span><span class="op">)</span>,
            mn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">bclen</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span>,
            sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">bclen</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tmp</span>
<span class="co">#&gt;   ann   n  mn   sd</span>
<span class="co">#&gt; 1   1 181  79  6.5</span>
<span class="co">#&gt; 2   2 178 114 10.5</span>
<span class="co">#&gt; 3   3 155 147 13.9</span>
<span class="co">#&gt; 4   4  71 173 15.3</span>
<span class="co">#&gt; 5   5  64 201 17.5</span>
<span class="co">#&gt; 6   6  64 235 23.3</span>
<span class="co">#&gt; 7   7  50 269 25.3</span>
<span class="co">#&gt; 8   8   2 283 26.9</span>
<span class="co">#&gt; 9   9   2 314 20.5</span></code></pre></div>
<p>Additionally, the mean length at each back-calculated age computed separately for each age-at-capture is found with <code><a href="https://rdrr.io/pkg/FSA/man/sumTable.html" class="external-link">sumTable()</a></code>, where the left side of the formula is the quantitative variable to be summarized and the right side has grouping variables presented in <code>row*column</code> format.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/FSA/man/sumTable.html" class="external-link">sumTable</a></span><span class="op">(</span><span class="va">bclen</span><span class="op">~</span><span class="va">agecap</span><span class="op">*</span><span class="va">ann</span>,data<span class="op">=</span><span class="va">SMBassWB_FL2</span>,digits<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt;    1   2   3   4   5   6   7   8   9</span>
<span class="co">#&gt; 1 74  NA  NA  NA  NA  NA  NA  NA  NA</span>
<span class="co">#&gt; 2 80 113  NA  NA  NA  NA  NA  NA  NA</span>
<span class="co">#&gt; 3 77 113 149  NA  NA  NA  NA  NA  NA</span>
<span class="co">#&gt; 4 71 122 161 194  NA  NA  NA  NA  NA</span>
<span class="co">#&gt; 6 80 108 136 169 199 230  NA  NA  NA</span>
<span class="co">#&gt; 7 82 118 145 171 202 237 269  NA  NA</span>
<span class="co">#&gt; 9 72 100 135 166 198 236 256 283 314</span></code></pre></div>
<p> </p>
<p> </p>
<hr>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Carlander, K.D. 1982. Standard intercepts for calculating lengths from scale measurements for some centrarchid and percid fishes. Transactions of the American Fisheries Society 111:332–336. <a href="https://www.tandfonline.com/doi/abs/10.1577/1548-8659(1982)111%3C332%3ASIFCLF%3E2.0.CO%3B2" class="external-link">Abstract</a></p></li>
<li><p>Ogle, D.H. 2016. Introductory Fisheries Analyses with R. CRC Press/Chapman &amp; Hall. <a href="https://derekogle.com/IFAR/" class="external-link">Webpage</a></p></li>
<li><p>Vigliola, L., and M.G. Meekan. 2009. The back-calculation of fish growth from otoliths. Pages 174-211 in Green, B., B. Mapstone, G. Carlos, and G. Begg, editors. Tropical fish otoliths: information for assessment, management and ecology, volume 11. Springer, Dordrecht, Netherlands. <a href="https://www.researchgate.net/publication/226394736_The_Back-Calculation_of_Fish_Growth_From_Otoliths" class="external-link">Full Text</a></p></li>
</ul>
<p> </p>
<p> </p>
</div>
<div class="section level2">
<h2 id="footnotes">Footnotes<a class="anchor" aria-label="anchor" href="#footnotes"></a>
</h2>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Both of these data.frames are available in the <code>RFishBC</code> package. However, these types of data could be the result of using <code>comineData()</code> and <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join()</a></code> or from loading a relevant CSV file as demonstrated in <a href="../MeasureRadii/collectRadiiData.html#outputdata">Output Data File section of the Collecting Radii Data</a> vignette.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Note that this file contains information from fish captured in years other than 1990.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Arranging the data by fish id is not required for the work below. It is simply used here for demonstration purposes.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>The <code>species</code>, <code>lake</code>, <code>gear</code>, <code>yearcap</code>, and <code>reading</code> variables are not needed in this vignette, but could be needed in further statistical analyses.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>If your data originated from somewhere else, then you may need to rename your variables to meet these conventions.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>If <code>a</code> is not provided by the user for the Fraser-Lee model, then it will be estimated from the intercepts of the linear regression of fish length on structure radius.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Derek Ogle.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
